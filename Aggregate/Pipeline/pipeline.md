#Pipeline Aggregation Stages
#管道聚集状态
<ol>
	<li>
		<ul>
			<li>$collStats:查询collection状态</li>
			<li>`{$collStats:{latencyStats:{histograms:<boolean>},storageStats:{}}}`</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$indexStats:查询索引状态</li>
			<li>{$indexStats:{}}></li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$project:查询显示字段</li>
			<li>{$project:{&lt;specification(s)&gt;}}</li>
			<li>
				<ul>
					<li>&lt;field&gt;: &lt;1 or true&gt;</li>
					<li>_id: &lt;0 or false&gt;</li>
					<li>&lt;field&gt;: &lt;expression&gt;</li>
					<li>&lt;field&gt;: &lt;0 or false&gt;</li>
				</ul>
			</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$match:根据条件筛选</li>
			<li>{$match:&lt;query&gt;}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$redact:根据文档存储限制文档内容</li>
			<li>{$redact:{$cond:{if:{&lt;query&gt;},then:"$$[PRUNE|DESCEND|KEEP]",else:"$$[PRUNE|DESCEND|KEEP]"}}}</li>
				<li>
					<ul>
						<li>PRUNE正匹配</li>
						<li>DESCEND逆匹配</li>
						<li>KEEP全匹配</li>
					</ul>
				</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$limit:限制记录条数</li>
			<li>{$limit:&lt;positive integer&gt;}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$skip:跳过记录数</li>
			<li>{$skip:&lt;positive integer&gt;}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$unwind:展开数据数据</li>
			<li>{$unwind:{path:&lt;field path&gt;,includeArrayIndex:&lt;string&gt;,preserveNullAndEmptyArrays:&lt;boolean&gt;}}</pre></li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$group:分组查询数据</li>
			<li>{$group:{_id:&lt;expression&gt;,&lt;field1&gt;:{&lt;accumulator1&gt;:&lt;expression1&gt;},...}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$sample:随机取样</li>
			<li>{$sample:{size:&lt;positive integer&gt;}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$sort:根据字段排序</li>
			<li>{$sort:{&lt;field1&gt;:&lt;sort order&gt;,&lt;field2&gt;:&lt;sort order&gt;...}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$geoNear:地图相关</li>
			<li></li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$lookup:外链接查询</li>
			<li>{$lookup:{from:&lt;collection to join&gt;,localField:&lt;field from the input documents&gt;,foreignField:&lt;field from the documents of the"from"collection&gt;,as:&lt;output array field&gt;}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$out:将查询结果输出到另一个新集合</li>
			<li>{$out:"&lt;output-collection&gt;"}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$facet:</li>
			<li>{$facet:{&lt;outputField1&gt;:[&lt;stage1&gt;,&lt;stage2&gt;,...],&lt;outputField2&gt;:[&lt;stage1&gt;,&lt;stage2&gt;,...],...}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$bucket:根据区间查询</li>
			<li>{$bucket:{groupBy:&lt;expression&gt;,boundaries:[&lt;lowerbound1&gt;,&lt;lowerbound2&gt;,...],default:&lt;literal&gt;,output:{&lt;output1&gt;:{&lt;$accumulator expression&gt;},...&lt;outputN&gt;:{&lt;$accumulator expression&gt;}}}}</li>
			<li>
				<ul>
					<li>boundaries:取值区间(含左边界不含右边界)</li>
					<li>default:无值的默认值</li>
				</ul>
			</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$bucketAuto:</li>
			<li>{$bucketAuto:{groupBy:&lt;expression&gt;,buckets:&lt;number&gt;,output:{&lt;output1&gt;:{&lt;$accumulator expression&gt;},...},granularity:&lt;string&gt;}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$sortByCount:</li>
			<li>{$sortByCount:&lt;expression&gt;}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$addFields:向数据中增加属性显示(无实际存储值)</li>
			<li>{$addFields:{&lt;newField&gt;:&lt;expression&gt;,...}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$replaceRoot:降低维度,显示子集</li>
			<li>{$replaceRoot:{newRoot:&lt;replacementDocument&gt;}}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$count:查询记录条数</li>
			<li>{$count:&lt;string&gt;}</li>
		</ul>
	</li>
	<li>
		<ul>
			<li>$graphLookup:</li>
			<li>{$graphLookup:{from:&lt;collection&gt;,startWith:&lt;expression&gt;,connectFromField:&lt;string&gt;,connectToField:&lt;string&gt;,as:&lt;string&gt;,maxDepth:&lt;number&gt;,depthField:&lt;string&gt;,restrictSearchWithMatch:&lt;document&gt;}}</li>
		</ul>
	</li>
</ol>
